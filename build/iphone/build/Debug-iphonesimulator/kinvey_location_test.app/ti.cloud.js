/*

 Titanium Cloud Module

 This module is used across three distinct platforms (iOS, Android, and Mobile Web), each with their own architectural
 demands upon it.

 Appcelerator Titanium is Copyright (c) 2009-2010 by Appcelerator, Inc.
 and licensed under the Apache Public License (version 2)

 Copyright 2008 Netflix, Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined
 in FIPS PUB 180-1
 Version 2.1a Copyright Paul Johnston 2000 - 2002.
 Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 Distributed under the BSD License
 See http://pajhome.org.uk/crypt/md5 for details.
*/
defineCloud(exports);
function defineCloud(l){function w(e,a,v){if(void 0===a)throw"Argument "+e+" was not provided!";if(typeof a!=v)throw"Argument "+e+" was an unexpected type! Expected: "+v+", Received: "+typeof a;}function o(e,a){w("data",e,"object");w("callback",a,"function");x(this);this.url||(this.url=this.restNamespace+"/"+this.restMethod+".json");var v=void 0==l.useSecure?!0:l.useSecure;l.debug&&Ti.API.info('ACS Request: { url: "'+this.url+'", verb: "'+this.verb+'", secure: '+(v?"YES":"NO")+", data: "+JSON.stringify(e)+
" })");p.send(this.url,this.verb,e,v,function(g){if(a){var e=g.response;e||(e={});g.meta&&"ok"==g.meta.status?(e.success=!0,e.error=!1,e.meta=g.meta,l.debug&&Ti.API.info(JSON.stringify(e))):(e.success=!1,e.error=!0,e.code=g.meta?g.meta.code:g.statusCode,e.message=g.meta?g.meta.message:g.message||g.statusText,l.debug&&Ti.API.error(e.code+": "+e.message));a(e)}})}function e(){o.call(this,2==arguments.length?arguments[0]:{},2==arguments.length?arguments[1]:arguments[0])}function y(e){o.call(this,{},
e)}function x(e){e.restNamespace||(e.restNamespace=e.property.toLowerCase());e.restMethod||(e.restMethod=e.method.toLowerCase())}var q={PROPERTY_TYPE_ONLY_LATEST:0,PROPERTY_TYPE_SLASH_COMBINE:1,PROPERTY_TYPE_IGNORE:2};q.build=function a(e,g){var l=g.children||[],s;for(s in l)if(l.hasOwnProperty(s)){var k=l[s],r=k.propertyTypes||g.propertyTypes||{};r.children=q.PROPERTY_TYPE_IGNORE;for(var d in g)if(g.hasOwnProperty(d))switch(r[d]||q.PROPERTY_TYPE_ONLY_LATEST){case q.PROPERTY_TYPE_ONLY_LATEST:k[d]=
void 0===k[d]?g[d]:k[d];break;case q.PROPERTY_TYPE_SLASH_COMBINE:var o=[];g[d]&&o.push(g[d]);k[d]&&o.push(k[d]);k[d]=o.join("/")}k.method&&!k.children?e[k.method]=function(a){return function(){return a.executor.apply(a,arguments)}}(k):k.property&&a(e[k.property]={},k)}};q.build(l,{verb:"GET",executor:o,children:[{method:"hasStoredSession",executor:function(){return p.hasStoredSession()}},{method:"retrieveStoredSession",executor:function(){return p.retrieveStoredSession()}},{property:"ACLs",children:[{method:"create",
verb:"POST"},{method:"update",verb:"PUT"},{method:"show"},{method:"remove",restMethod:"delete",verb:"DELETE"},{method:"addUser",restMethod:"add",verb:"POST"},{method:"removeUser",restMethod:"remove",verb:"DELETE"},{method:"checkUser",restMethod:"check"}]},{property:"Chats",children:[{method:"create",verb:"POST"},{method:"query"},{method:"getChatGroups",restMethod:"get_chat_groups",executor:e}]},{property:"Checkins",children:[{method:"create",verb:"POST"},{method:"query",executor:e},{method:"show"},
{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"Clients",children:[{method:"geolocate",executor:e}]},{property:"Objects",executor:function(a,e){var g;a&&"object"==typeof a&&(w("data.classname",a.classname,"string"),x(this),this.url=this.restNamespace+"/"+a.classname+"/"+this.restMethod+".json",g=a.classname,delete a.classname);o.call(this,a,e);a.classname=g},children:[{method:"create",verb:"POST"},{method:"show"},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"},
{method:"query"}]},{property:"Emails",restNamespace:"custom_mailer",children:[{method:"send",verb:"POST",restMethod:"email_from_template"}]},{property:"Events",children:[{method:"create",verb:"POST"},{method:"show"},{method:"showOccurrences",restMethod:"show/occurrences"},{method:"query",executor:e},{method:"queryOccurrences",restMethod:"query/occurrences",executor:e},{method:"search",executor:e},{method:"searchOccurrences",restMethod:"search/occurrences",executor:e},{method:"update",verb:"PUT"},
{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"Files",children:[{method:"create",verb:"POST"},{method:"query",executor:e},{method:"show"},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"Friends",children:[{method:"add",verb:"POST"},{method:"requests",executor:e},{method:"approve",verb:"PUT"},{method:"remove",verb:"DELETE"},{method:"search"}]},{property:"KeyValues",children:[{method:"set",verb:"PUT"},{method:"get"},{method:"append",verb:"PUT"},
{method:"increment",restMethod:"incrby",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"Messages",children:[{method:"create",verb:"POST"},{method:"reply",verb:"POST"},{method:"show"},{method:"showInbox",restMethod:"show/inbox",executor:e},{method:"showSent",restMethod:"show/sent",executor:e},{method:"showThreads",restMethod:"show/threads",executor:e},{method:"showThread",restMethod:"show/thread"},{method:"remove",restMethod:"delete",verb:"DELETE"},{method:"removeThread",
restMethod:"delete/thread",verb:"DELETE"}]},{property:"Photos",children:[{method:"create",verb:"POST"},{method:"show"},{method:"search"},{method:"query",executor:e},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"PhotoCollections",restNamespace:"collections",children:[{method:"create",verb:"POST"},{method:"show"},{method:"update",verb:"PUT"},{method:"search"},{method:"showSubcollections",restMethod:"show/subcollections"},{method:"showPhotos",restMethod:"show/photos"},
{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"Places",children:[{method:"create",verb:"POST"},{method:"search",executor:e},{method:"show"},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"},{method:"query",executor:e}]},{property:"Posts",children:[{method:"create",verb:"POST"},{method:"show"},{method:"query",executor:e},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"PushNotifications",restNamespace:"push_notification",
verb:"POST",children:[{method:"subscribe"},{method:"unsubscribe",verb:"DELETE"},{method:"notify"}]},{property:"Reviews",children:[{method:"create",verb:"POST"},{method:"show"},{method:"query"},{method:"update",verb:"PUT"},{method:"remove",restMethod:"delete",verb:"DELETE"}]},{property:"SocialIntegrations",restNamespace:"users",children:[{method:"externalAccountLogin",restMethod:"external_account_login",verb:"POST"},{method:"externalAccountLink",restMethod:"external_account_link",verb:"POST"},{method:"externalAccountUnlink",
restMethod:"external_account_unlink",verb:"DELETE"},{method:"searchFacebookFriends",restNamespace:"social",restMethod:"facebook/search_friends",executor:y}]},{property:"Statuses",children:[{method:"create",verb:"POST"},{method:"search"},{method:"query",executor:e}]},{property:"Users",children:[{method:"create",verb:"POST"},{method:"login",verb:"POST"},{method:"show"},{method:"showMe",restMethod:"show/me",executor:y},{method:"search",executor:e},{method:"query",executor:e},{method:"update",verb:"PUT"},
{method:"logout",executor:function(a){o.call(this,{},function(e){p.reset();a(e)})}},{method:"remove",restMethod:"delete",verb:"DELETE",executor:function(){var a=arguments;o.call(this,2==a.length?a[0]:{},function(e){p.reset();(2==a.length?a[1]:a[0])(e)})}},{method:"requestResetPassword",restMethod:"request_reset_password"}]}]});var p=function(){var a;function e(b,f){b[f>>5]|=128<<24-f%32;b[(f+64>>9<<4)+15]=f;for(var c=Array(80),a=1732584193,d=-271733879,i=-1732584194,h=271733878,u=-1009589776,m=0;m<
b.length;m+=16){for(var k=a,z=d,l=i,o=h,p=u,n=0;80>n;n++){c[n]=16>n?b[m+n]:(c[n-3]^c[n-8]^c[n-14]^c[n-16])<<1|(c[n-3]^c[n-8]^c[n-14]^c[n-16])>>>31;var q=a<<5|a>>>27,r;r=20>n?d&i|~d&h:40>n?d^i^h:60>n?d&i|d&h|i&h:d^i^h;q=g(g(q,r),g(g(u,c[n]),20>n?1518500249:40>n?1859775393:60>n?-1894007588:-899497514));u=h;h=i;i=d<<30|d>>>2;d=a;a=q}a=g(a,k);d=g(d,z);i=g(i,l);h=g(h,o);u=g(u,p)}return[a,d,i,h,u]}function g(b,f){var c=(b&65535)+(f&65535);return(b>>16)+(f>>16)+(c>>16)<<16|c&65535}function o(b){for(var f=
[],c=(1<<t)-1,a=0;a<b.length*t;a+=t)f[a>>5]|=(b.charCodeAt(a/t)&c)<<32-t-a%32;return f}function s(b,f,c){f?(this.oauthKey=b,this.oauthSecret=f):this.appKey=b;this.apiBaseURL=c?c:a.sdk.url.baseURL;return this}function k(b,f){var c,a="production"==Ti.App.deployType.toLowerCase()?"production":"development";return(c=Ti.App.Properties.getString(b+"-"+a))&&"undefined"!=c||(c=Ti.App.Properties.getString(b))&&"undefined"!=c?c:f}var r={},d;null==d&&(d={});d.setProperties=function(b,f){if(null!=b&&null!=f)for(var c in f)b[c]=
f[c];return b};d.setProperties(d,{percentEncode:function(b){if(null==b)return"";if(b instanceof Array){for(var f="";0<b.length;++b)""!=f&&(f+="&"),f+=d.percentEncode(b[0]);return f}b=encodeURIComponent(b);b=b.replace(/\!/g,"%21");b=b.replace(/\*/g,"%2A");b=b.replace(/\'/g,"%27");b=b.replace(/\(/g,"%28");return b=b.replace(/\)/g,"%29")},decodePercent:function(b){null!=b&&(b=b.replace(/\+/g," "));return decodeURIComponent(b)},getParameterList:function(b){if(null==b)return[];if("object"!=typeof b)return d.decodeForm(b+
"");if(b instanceof Array)return b;var f=[],c;for(c in b)f.push([c,b[c]]);return f},getParameterMap:function(b){if(null==b)return{};if("object"!=typeof b)return d.getParameterMap(d.decodeForm(b+""));if(b instanceof Array){for(var f={},c=0;c<b.length;++c){var a=b[c][0];void 0===f[a]&&(f[a]=b[c][1])}return f}return b},getParameter:function(b,f){if(b instanceof Array)for(var c=0;c<b.length;++c){if(b[c][0]==f)return b[c][1]}else return d.getParameterMap(b)[f];return null},formEncode:function(b){for(var f=
"",b=d.getParameterList(b),c=0;c<b.length;++c){var a=b[c][1];null==a&&(a="");""!=f&&(f+="&");f+=d.percentEncode(b[c][0])+"="+d.percentEncode(a)}return f},decodeForm:function(b){for(var f=[],b=b.split("&"),c=0;c<b.length;++c){var a=b[c];if(""!=a){var e=a.indexOf("="),i;0>e?(i=d.decodePercent(a),a=null):(i=d.decodePercent(a.substring(0,e)),a=d.decodePercent(a.substring(e+1)));f.push([i,a])}}return f},setParameter:function(b,f,c){var a=b.parameters;if(a instanceof Array){for(b=0;b<a.length;++b)a[b][0]==
f&&(void 0===c?a.splice(b,1):(a[b][1]=c,c=void 0));void 0!==c&&a.push([f,c])}else a=d.getParameterMap(a),a[f]=c,b.parameters=a},setParameters:function(b,f){for(var c=d.getParameterList(f),a=0;a<c.length;++a)d.setParameter(b,c[a][0],c[a][1])},completeRequest:function(b,f){null==b.method&&(b.method="GET");var c=d.getParameterMap(b.parameters);null==c.oauth_consumer_key&&d.setParameter(b,"oauth_consumer_key",f.consumerKey||"");null==c.oauth_token&&null!=f.token&&d.setParameter(b,"oauth_token",f.token);
null==c.oauth_version&&d.setParameter(b,"oauth_version","1.0");null==c.oauth_timestamp&&d.setParameter(b,"oauth_timestamp",d.timestamp());null==c.oauth_nonce&&d.setParameter(b,"oauth_nonce",d.nonce(6));d.SignatureMethod.sign(b,f)},setTimestampAndNonce:function(b){d.setParameter(b,"oauth_timestamp",d.timestamp());d.setParameter(b,"oauth_nonce",d.nonce(6))},addToURL:function(b,f){newURL=b;if(null!=f){var c=d.formEncode(f);0<c.length&&(newURL=0>b.indexOf("?")?newURL+"?":newURL+"&",newURL+=c)}return newURL},
getAuthorizationHeader:function(b,f){for(var c='OAuth realm="'+d.percentEncode(b)+'"',a=d.getParameterList(f),e=0;e<a.length;++e){var i=a[e],h=i[0];0==h.indexOf("oauth_")&&(c+=","+d.percentEncode(h)+'="'+d.percentEncode(i[1])+'"')}return c},correctTimestamp:function(b){d.timeCorrectionMsec=1E3*b-(new Date).getTime()},timeCorrectionMsec:0,timestamp:function(){var b=(new Date).getTime()+d.timeCorrectionMsec;return Math.floor(b/1E3)},nonce:function(b){for(var f=d.nonce.CHARS,c="",a=0;a<b;++a)var e=Math.floor(Math.random()*
f.length),c=c+f.substring(e,e+1);return c}});d.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";d.declareClass=function(b,a,c){var d=b[a];b[a]=c;if(null!=c&&null!=d)for(var e in d)"prototype"!=e&&(c[e]=d[e]);return c};d.declareClass(d,"SignatureMethod",function(){});d.setProperties(d.SignatureMethod.prototype,{sign:function(b){var a=this.getSignature(d.SignatureMethod.getBaseString(b));d.setParameter(b,"oauth_signature",a);return a},initialize:function(b,a){var c;c=null!=
a.accessorSecret&&9<b.length&&"-Accessor"==b.substring(b.length-9)?a.accessorSecret:a.consumerSecret;this.key=d.percentEncode(c)+"&"+d.percentEncode(a.tokenSecret)}});d.setProperties(d.SignatureMethod,{sign:function(b,a){var c=d.getParameterMap(b.parameters).oauth_signature_method;if(null==c||""==c)c="HMAC-SHA1",d.setParameter(b,"oauth_signature_method",c);d.SignatureMethod.newMethod(c,a).sign(b)},newMethod:function(b,a){var c=d.SignatureMethod.REGISTERED[b];if(null!=c){var e=new c;e.initialize(b,
a);return e}var c=Error("signature_method_rejected"),j="";for(e in d.SignatureMethod.REGISTERED)""!=j&&(j+="&"),j+=d.percentEncode(e);c.oauth_acceptable_signature_methods=j;throw c;},REGISTERED:{},registerMethodClass:function(b,a){for(var c=0;c<b.length;++c)d.SignatureMethod.REGISTERED[b[c]]=a},makeSubclass:function(b){var a=d.SignatureMethod,c=function(){a.call(this)};c.prototype=new a;c.prototype.getSignature=b;return c.prototype.constructor=c},getBaseString:function(b){var a=b.action,c=a.indexOf("?");
if(0>c)c=b.parameters;else for(var c=d.decodeForm(a.substring(c+1)),e=d.getParameterList(b.parameters),j=0;j<e.length;++j)c.push(e[j]);return d.percentEncode(b.method.toUpperCase())+"&"+d.percentEncode(d.SignatureMethod.normalizeUrl(a))+"&"+d.percentEncode(d.SignatureMethod.normalizeParameters(c))},normalizeUrl:function(b){var a=d.SignatureMethod.parseUri(b),b=a.protocol.toLowerCase(),c=a.authority.toLowerCase();if("http"==b&&80==a.port||"https"==b&&443==a.port){var e=c.lastIndexOf(":");0<=e&&(c=
c.substring(0,e))}(a=a.path)||(a="/");return b+"://"+c+a},parseUri:function(b){for(var a="source,protocol,authority,userInfo,user,password,host,port,relative,path,directory,file,query,anchor".split(","),b=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(b),c={},d=14;d--;)c[a[d]]=b[d]||"";return c},normalizeParameters:function(b){if(null==b)return"";for(var a=d.getParameterList(b),b=[],c=0;c<a.length;++c){var e=
a[c];"oauth_signature"!=e[0]&&b.push([d.percentEncode(e[0])+" "+d.percentEncode(e[1]),e])}b.sort(function(b,a){return b[0]<a[0]?-1:b[0]>a[0]?1:0});a=[];for(c=0;c<b.length;++c)a.push(b[c][1]);return d.formEncode(a)}});d.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],d.SignatureMethod.makeSubclass(function(){return this.key}));d.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],d.SignatureMethod.makeSubclass(function(b){q="=";var a=this.key,c=o(a);16<c.length&&
(c=e(c,a.length*t));for(var d=Array(16),a=Array(16),j=0;16>j;j++)d[j]=c[j]^909522486,a[j]=c[j]^1549556828;b=e(d.concat(o(b)),512+b.length*t);b=e(a.concat(b),672);c="";for(a=0;a<4*b.length;a+=3){d=(b[a>>2]>>8*(3-a%4)&255)<<16|(b[a+1>>2]>>8*(3-(a+1)%4)&255)<<8|b[a+2>>2]>>8*(3-(a+2)%4)&255;for(j=0;4>j;j++)c=8*a+6*j>32*b.length?c+q:c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-j)&63)}return c}));var q="",t=8;s.prototype.sendRequest=function(b,f,c,e,j){var i=a.js.sdk.utils.getAuthType(this);
if(i==a.constants.unknown)j(a.constants.noAppKeyError);else{var h="",h=e?h+a.sdk.url.https:h+a.sdk.url.http,h=h+(this.apiBaseURL+"/"+a.sdk.url.version+"/"+b);i==a.constants.app_key&&(h+=a.constants.keyParam+this.appKey);c||(c={});f=f?f.toUpperCase():a.constants.get_method;c[a.constants.suppressCode]="true";(e=a.js.sdk.utils.retrieveSessionId())&&(h+=(-1!=h.indexOf("?")?"&":"?")+a.constants.sessionId+"="+e);e=c;if(Ti.App.analytics){var g=e.analytics||{};g.id=Ti.Platform.createUUID();Ti.Platform.id&&
(g.mid=Ti.Platform.id);g.aguid=Ti.App.guid;g.event="cloud."+b.replace(/\//g,".").replace(/\.json/,"");g.deploytype=Ti.App.deployType||"development";g.sid=Ti.App.sessionId;e.ti_analytics=JSON.stringify(g)}c=a.js.sdk.utils.cleanInvalidData(c);if(b=a.js.sdk.utils.getFileObject(c)){try{var m;m=b.toString().match(/TiFilesystemFile/)?b.read():b;if(!m){j(a.constants.fileLoadError);return}c[a.constants.file]?(delete c[a.constants.file],c[a.constants.file]=m):c[a.constants.photo]&&(delete c[a.constants.photo],
c[a.constants.photo]=m)}catch(k){j(a.constants.fileLoadError);return}m={};i==a.constants.oauth&&(h+=(-1!=h.indexOf("?")?"&":"?")+a.constants.oauth_consumer_key+"="+this.oauthKey,i={method:f,action:h,parameters:[]},a.js.sdk.utils.populateOAuthParameters(i.parameters,this.oauthKey),d.completeRequest(i,{consumerSecret:this.oauthSecret}),m.Authorization=d.getAuthorizationHeader("",i.parameters))}else if(m={},i==a.constants.oauth){var h=h+((-1!=h.indexOf("?")?"&":"?")+a.constants.oauth_consumer_key+"="+
this.oauthKey),i={method:f,action:h,parameters:[]},l;for(l in c)c.hasOwnProperty(l)&&i.parameters.push([l,c[l]]);a.js.sdk.utils.populateOAuthParameters(i.parameters,this.oauthKey);d.completeRequest(i,{consumerSecret:this.oauthSecret});m.Authorization=d.getAuthorizationHeader("",i.parameters)}a.js.sdk.utils.sendAppceleratorRequest(h,f,c,m,j)}};a=void 0;a={constants:{},js:{}};a.js.sdk={};a.js.sdk.utils={};a.sdk={};a.sdk.url={};a.sdk.url.http="http://";a.sdk.url.https="https://";a.sdk.url.baseURL="api.cloud.appcelerator.com";
a.sdk.url.version="v1";a.constants.app_key=1;a.constants.oauth=2;a.constants.unknown=-1;a.constants.keyParam="?key=";a.constants.file="file";a.constants.photo="photo";a.constants.suppressCode="suppress_response_codes";a.constants.sessionId="_session_id";a.constants.oauth_consumer_key="oauth_consumer_key";a.constants.noAppKeyError={meta:{status:"fail",code:409,message:"Application key is not provided."}};a.constants.fileLoadError={meta:{status:"fail",code:400,message:"Unable to load file"}};a.js.sdk.utils.sessionId=
null;a.js.sdk.utils.retrieveSessionId=function(){null===a.js.sdk.utils.sessionId&&(a.js.sdk.utils.sessionId=Ti.App.Properties.getString("ACS-StoredSessionId"));return a.js.sdk.utils.sessionId&&"undefined"!=a.js.sdk.utils.sessionId?a.js.sdk.utils.sessionId:null};a.js.sdk.utils.storeSessionId=function(b){b&&(a.js.sdk.utils.sessionId=b,Ti.App.Properties.setString("ACS-StoredSessionId",b))};a.js.sdk.utils.clearSessionId=function(){a.js.sdk.utils.sessionId=!1;Ti.App.Properties.setString("ACS-StoredSessionId",
"")};a.js.sdk.utils.getAuthType=function(b){if(b){if(b.appKey)return a.constants.app_key;if(b.oauthKey&&b.oauthSecret)return a.constants.oauth}return a.constants.unknown};a.js.sdk.utils.getFileObject=function(b){if(b)for(var d in b)if(b.hasOwnProperty(d)&&(d==a.constants.photo||d==a.constants.file))return b[d];return null};a.js.sdk.utils.cleanInvalidData=function(b){if(b){for(var d in b)if(b.hasOwnProperty(d)){null==b[d]&&delete b[d];if("object"==typeof b[d]){if(d==a.constants.photo||d==a.constants.file)continue;
b[d]=JSON.stringify(b[d])}if(!0===b[d]||!1===b[d])b[d]=b[d]?1:0}return b}return{}};a.js.sdk.utils.uploadMessageCallback=function(b){return b&&b.data?JSON.parse(b.data):{}};a.js.sdk.utils.getOAuthParameters=function(b){var a="";if(b)for(var b=d.getParameterList(b),c=0;c<b.length;++c){var e=b[c],g=e[0];0==g.indexOf("oauth_")&&"oauth_token"!=g&&(a+="&"+d.percentEncode(g)+"="+d.percentEncode(e[1]))}0<a.length&&(a=a.substring(1));return a};a.js.sdk.utils.populateOAuthParameters=function(a,e){a&&e&&(a.push(["oauth_version",
"1.0"]),a.push(["oauth_consumer_key",e]),a.push(["oauth_signature_method","HMAC-SHA1"]),a.push(["oauth_nonce",d.nonce(15)]))};a.js.sdk.utils.sendAppceleratorRequest=function(b,e,c,g,j){var i=Ti.Network.createHTTPClient({timeout:6E4,onsendstream:function(a){l.onsendstream&&l.onsendstream({url:b,progress:a.progress})},ondatastream:function(a){l.ondatastream&&l.ondatastream({url:b,progress:a.progress})},onerror:function(a){var b={},c=this.responseText;try{(c=c.trim())&&0<c.length&&(b=JSON.parse(c))}catch(d){b=
d}b.message||(b.message=a.error);b.error=!0;b.statusText=this.statusText;b.status=this.status;b.meta&&(b.metaString=JSON.stringify(b.meta));j(b)},onload:function(){var b=JSON.parse(this.responseText);b&&b.meta&&(b.metaString=JSON.stringify(b.meta),a.js.sdk.utils.storeSessionId(b.meta.session_id));j(b)}}),h=b;if("GET"==e||"DELETE"==e){var k="",m;for(m in c)c.hasOwnProperty(m)&&(k+="&"+m+"="+d.percentEncode(c[m]));0<k.length&&(h=0<b.indexOf("?")?h+k:h+("?"+k.substring(1)),c={})}l.debug&&(Ti.API.info(e+
": "+h),Ti.API.info("header: "+JSON.stringify(g)),Ti.API.info("data: "+JSON.stringify(c)));i.open(e,h);i.setRequestHeader("Accept-Encoding","gzip,deflate");if(g)for(m in g)g.hasOwnProperty(m)&&i.setRequestHeader(m,g[m]);i.send(c)};var p=null;r.send=function(a,d,c,e,g){if(null==p){var i=k("acs-api-key",null),h=k("acs-base-url","api.cloud.appcelerator.com"),l=k("acs-oauth-key",null),m=k("acs-oauth-secret",null);if(l&&m)p=new s(l,m,h);else if(i)p=new s(i,null,h);else throw"ACS CREDENTIALS NOT SPECIFIED!";
}p.sendRequest(a,d,c,e,g)};r.hasStoredSession=function(){return!!a.js.sdk.utils.retrieveSessionId()};r.retrieveStoredSession=function(){return a.js.sdk.utils.retrieveSessionId()};r.reset=function(){a.js.sdk.utils.clearSessionId();p=null};return r}();return l};